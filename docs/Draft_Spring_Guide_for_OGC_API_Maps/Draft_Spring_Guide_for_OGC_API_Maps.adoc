== Getting Started with OGC API - Maps for spring.io developers

This Getting Started guide introduces spring.io developers to working with API definition files for OGC API - Maps. The guide is inspired by the https://reflectoring.io/spring-boot-openapi/[API-First Development with Spring Boot and Swagger] tutorial on reflectoring.io.

First create a basic sprint boot application at http://start.sprint.io

Ensure that you select Sprint Web as a dependency.

image::images/image1.png[width=601,height=389]

Download the project by clicking on the GENERATE button.

Add the following to the pom.xml file.

[source,xml]
----
<plugin>
   <groupId>org.openapitools</groupId>
   <artifactId>openapi-generator-maven-plugin</artifactId>
   <version>4.2.3</version>
   <executions>
      <execution>
         <goals>
            <goal>generate</goal>
         </goals>
         <configuration>
            <inputSpec>
               ${project.basedir}/src/main/resources/maps.yaml
            </inputSpec>
            <generatorName>spring</generatorName>
            <apiPackage>org.ogc.api</apiPackage>
            <modelPackage>org.ogc.model</modelPackage>
            <supportingFilesToGenerate>
               ApiUtil.java
            </supportingFilesToGenerate>
            <configOptions>
               <delegatePattern>true</delegatePattern>
            </configOptions>
         </configuration>
      </execution>
   </executions>
</plugin>

----

We are next going to add a series of libraries to the pom.xml file. Some
of those libraries have the same version number, so to make it easier to
manage the version numbers we will add the version numbers to the
pom.xml file as properties. This is shown below.

[source,xml]
----
|<properties>
<java.version>11</java.version>
…Additional properties go here…
</properties>
----

You will need to add the following libraries.

[source,xml]
----
<dependency>
   <groupId>org.springframework.boot</groupId>
   <artifactId>spring-boot-starter-validation</artifactId>
</dependency>
<dependency>
   <groupId>io.swagger</groupId>
   <artifactId>swagger-annotations</artifactId>
   <version>${swagger-annotations-version}</version>
</dependency>
<dependency>
   <groupId>org.openapitools</groupId>
   <artifactId>jackson-databind-nullable</artifactId>
   <version>${jackson-databind-nullable}</version>
</dependency>
<dependency>
   <groupId>com.fasterxml.jackson.jaxrs</groupId>
   <artifactId>jackson-jaxrs-base</artifactId>
   <version>${jackson-version}</version>
</dependency>
<dependency>
   <groupId>com.fasterxml.jackson.core</groupId>
   <artifactId>jackson-core</artifactId>
   <version>${jackson-version}</version>
</dependency>
<dependency>
   <groupId>com.fasterxml.jackson.core</groupId>
   <artifactId>jackson-annotations</artifactId>
   <version>${jackson-version}</version>
</dependency>
<dependency>
   <groupId>com.fasterxml.jackson.core</groupId>
   <artifactId>jackson-databind</artifactId>
   <version>${jackson-version}</version>
</dependency>
<dependency>
   <groupId>com.fasterxml.jackson.jaxrs</groupId>
   <artifactId>jackson-jaxrs-json-provider</artifactId>
   <version>${jackson-version}</version>
</dependency>
<dependency>
   <groupId>com.fasterxml.jackson.datatype</groupId>
   <artifactId>jackson-datatype-joda</artifactId>
   <version>${jackson-version}</version>
</dependency>
----

So the properties should look as follows.

[source,xml]
----
<properties>
   <java.version>11</java.version>
   <swagger-annotations-version>1.5.22</swagger-annotations-version>
   <jackson-version>2.10.2</jackson-version>
   <jackson-databind-nullable>0.2.1</jackson-databind-nullable>
</properties>
----

Now compile the OpenAPI definition by running the command:

$ mvn clean package

This will generate a stub of the API. Due to a current limitation of
OpenAPITools Generator (see
https://github.com/OpenAPITools/openapi-generator/issues/5381) the
compilation fails to handle elements defined as ‘oneOf’ options. So, you
will see a compilation such as shown below.

image::images/image2.png[width=447,height=314]

As a workaround, create a class called OneOfstringinteger in the
org.ogc.model package.

image::images/image3.png[width=601,height=319]

Now re-compile the OpenAPI definition by running the command:

$ mvn clean package

If successful, you should arrive at a BUILD SUCCESS message.

image::images/image4.png[width=461,height=309]

At this point, you now have the API and model stub that you will need to
implement an interface that conforms to OGC API – Maps.

In the ‘target’ folder you will find a folder called ‘generated-sources’
that includes stubs for the API controllers and model.

image::images/image5.png[width=311,height=608]

The classes CollectionsApi, ConformanceApi, DefaultApi, and MapApi
contain the request mappings for each path specified in the OpenAPI
definition. These API stubs also have associated Controller classes
namely CollectionsApiController, ConformanceApiController,
DefaultApiController, and MapApiController.

So we next override the methods provided by the Controller classes
generated by the OpenAPITools Generator. Overriding these methods
enables us to add business logic to those methods.

So we create a class called SimpleMapApi1Controller to sit alongside the
SimpleMapApi1Application that was created by the initializr on
start.sprint.io in Step #.

image::images/image6.png[width=362,height=306]

Next copy the stub of the DefaultApi.getLandingPage method into the
SimpleMapApi1Controller class.

**To Be Completed...**
